<!DOCTYPE html>
<html>
<head>
	<title>Image Upload</title>
	<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
	<style type="text/css">
		#drop-area {
			width: 100px;
			height: 100px;
			border: 1px dashed black;
		}
		.is-occupy {
			background: gray;
		}
	</style>
	<script type="text/javascript">
		var supportMultiFile = function () {
			var inp = document.createElement("input");
			inp.setAttribute("multiple", "true");
			var supportsMultiple = inp.multiple===true;
			return supportsMultiple;
		}

		var supportXHR2 = function () {
			if (new XMLHttpRequest().upload) {
				alert("support!");
			}
		}

		var fileSelect = function (files) {
			$('.file')[0].files = files;
			// for (var i = 0; i < files.length; i++) {
			// 	var f = files[i];
			// 	var reader = new FileReader();
			// 	reader.load = function (e) {

			// 	}
			// }
		}

		var dropIt = function (e) {
			console.log(e);
			console.log(e.dataTransfer);
			fileSelect(e.dataTransfer.files);
			e.stopPropagation();  
			e.preventDefault(); 
		}
		

		$(function () {
			$('button#clear').click(function () {
				var control = $(".file");
				control.replaceWith(control.val('').clone(true));
			})				

			$('button#check').click(function () {
				if ($('.file')[0].files) alert('support!');
			})

			$('button#check_xhr2').click(function () {
				supportXHR2();
			})

			// drop
			$('#drop-area')[0].addEventListener('drop', dropIt, false);
			// $('#drop-area').on('drop', dropIt);


			// drag over
			// $('#drop-area').on('dragover', function (e) {
			// 	$(this).addClass('is-occupy');
			// });
			// $('#drop-area')[0].addEventListener('dragover', function (e) {
			// 	$(this).addClass('is-occupy');
			// }, false);
		})

	</script>
</head>
<body>
	<button id="clear" class="btn">clear</button>
	<button id="check" class="btn">check FileList</button>
	<button id="check_xhr2" class="btn">check XHR2</button>
	<form target="upload-frame" method="post" action="/upload" enctype="multipart/form-data">
		<input id="file" class="file" type="file" name="image" multiple>
		<input type="submit" value="提交">
	</form>
	<iframe width="50" height="50" name="upload-frame" src=""></iframe>
	<div id="drop-area" ondragenter="return false" ondragover="return false">drop here</div>
</body>
</html>